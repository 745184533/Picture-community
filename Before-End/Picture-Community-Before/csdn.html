<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css"/>
		<link rel="stylesheet" type="text/css" href="css/page.css"/>
		<link rel="stylesheet" type="text/css" href="css/page凯.css"/>
		<script src="js/jquery.min.js"></script>
		<script src="js/bootstrap.min.js"></script>
		<link rel="stylesheet" type="text/css" href="css/information.css" />
		<link rel="stylesheet" type="text/css" href="css/csdn.css"/>
		<title>图片社区</title>
	</head>
	<body background="img/002.jpg">
		
		
		
		<!-- 导航栏 -->
		<div class="title-style">
			<div class="nav-style">
				<div class="navbar-nav">
					<ul class="nav nav-tabs" role="tablist">
						<li role="presentation" style="margin: 0 40px 0 0;" >
							<span style="height: 40px;line-height: 40px;font-weight: bold;font-size: 18px;" id="mainPage">
								<a href="new凯.html" style="text-decoration: none;">图片社区</a>
							</span>
						</li>
						<li role="presentation" style="margin: 0 20px 0 0;position: absolute;top:0px;left: 150px;display: flex;">
							<div style="width: 40px;height: 40px;background-color: white;border:none;border-bottom: 1px solid #0A88D3 ; border-top: 1px solid #0A88D3 ;">
								<svg width="40px" height="40px" viewBox="0 0 16 16" class="bi bi-search" style="padding-left: 10px; padding-top:15px;background-color: white;position: absolute;top:-5px" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
									<path fill-rule="evenodd" d="M10.442 10.442a1 1 0 0 1 1.415 0l3.85 3.85a1 1 0 0 1-1.414 1.415l-3.85-3.85a1 1 0 0 1 0-1.415z"/>
									<path fill-rule="evenodd" d="M6.5 12a5.5 5.5 0 1 0 0-11 5.5 5.5 0 0 0 0 11zM13 6.5a6.5 6.5 0 1 1-13 0 6.5 6.5 0 0 1 13 0z"/>
								</svg>
							</div>
							<input type="text" id="search" style="width: 300px;height: 40px;font-size: 16px;border: none;border-top: 1px solid #0A88D3 ;border-bottom: #0A88D3 1px solid;"/>
						</li>
						<li role="presentation" class="dropdown" style="margin: 0 200px 0 910px;">
						    <button class="btn btn-primary dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown"
						      aria-haspopup="true" aria-expanded="true">探索
							<span class="caret"></span>
						    </button>
							<table class="dropdown-menu" aria-labelledby="dropdownMenu1">
								<tr>
									<th>About</th>
								</tr>
								<tr>
									<td id="blog">
										<a href="csdn.html" style="text-decoration: none;">博客</a>
									</td>
								</tr>
								<tr>
									<td id="exit">
										<a style="text-decoration: none;">注销</a>	
									</td>
								</tr>
								<tr>
									<td id="us">
										<a href="us.html" style="text-decoration: none;">关于我们</a>
										
									</td>
								</tr>
							</table>
						</li>
						<div id="navbar" style="position: absolute;left: 1200px; top:10px; display: flex;">
							<li style="margin: 0 40px 0 20px;"><a id="login" style="color: black;text-decoration: none;" href="loginPage.html">登录</a></li>
							<li style="margin: 0 40px 0 20px;"><a id="register" style="color: black;text-decoration: none;" href="registerPage.html">注册</a></li>
						</div>
					</ul>
				</div>
			</div>
		</div>
		
		<script>
			if(localStorage.userId!=undefined&&localStorage.userId!="")
			{
				console.log(localStorage.userId);
				$("#login").hide();
				$("#register").hide();
				$("#exit").show();
				var username=$("<span></span>").text("您好！"+localStorage.userName);
				username.css("position","absolute");
				username.css("left","-15px");
				username.css("top","-1px");
				$("#navbar").append(username);
				username.click(function(){
					//跳转
					window.location.href="个人图片主页.html";
				})
			}
			else
			{
				$("#exit").hide();
			}
			$("#exit").click(function(){
				localStorage.Token="";
				localStorage.picId="";
				localStorage.userId="";
				localStorage.tag="";
				localStorage.userName="";
				username.hide();
				$("#login").show();
				$("#register").show();
			});
			$("#search").bind("keyup",function(event){
				if(event.keyCode=="13")
				{
					localStorage.tag=$("#search").val();
					window.location.href="showPicture.html";
					document.getElementById("search").value="";
				}
			});
		</script>
		
		
		<div id="content" class="clearfix">
			<div style="margin: 30px auto;">
				<div id="account_tabs" class="tab_menu hide-xs hide-sm hide-md" style="margin:auto;border-top:0">
					<div style="max-width:1440px;margin:auto;padding:0 5px;text-align:left">
						<a style="float:right" href="个人图片主页.html">
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">我的简历
								</font>
							</font>
						</a>
						<a href="pictureShow.html">
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">图片
								</font>
							</font>
						</a>
						<a href="csdn.html" class="selected">
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">博客
								</font>
							</font>
						</a>
						<a href="moneyPay.html">
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">钱包
								</font>
							</font>
						</a>
						<a href="myinformation.html">
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">设置
								</font>
							</font>
						</a>
					</div>
				</div>
			</div>
			<div class="csdn-box" id="csdnbox1">
				
			</div>
			<center style="width:100%">
				<button class="btn-success" onclick="writtingblog()" style="text-align: center;width: 200px;">写博客</button>
			</center>	
			<div id="writting"></div>
		</div>

						
			<script>
			//localStorage.id=5;
				var usernam="gyq";
				usernam=localStorage.userId;
				usernam=""+usernam;
			if(localStorage.userId!=undefined)
			{
			
				console.log(localStorage.userId);
				$("#login").hide();
				$("#register").hide();
				var username=$("<span></span>").text("您好！"+localStorage.userName);
				username.css("position","absolute");
				username.css("left","-15px");
				username.css("top","-1px");
				$("#navbar").append(username);
				username.click(function(){
					//跳转
					window.location.href="个人图片主页.html";
				})
			}
				
				function getblog(){
					$.ajax({
					  "url": "http://172.81.239.44/Blog/getTen?times=0",
					  "method": "GET",
					  "timeout": 0,
					success:function(data){
						console.log(data);
						var arr=data.list;
					arr.forEach(function(item,index){
						//console.log(data.returnList);
						var arr=data.returnList;
						//console.log(arr);
						var box=$("<div></div>");
						var article=$("<div></div>");
						var writter=$("<span></span>").text(item.userName+": ");
						writter.css("color","#000000");
						var content=$("<span></span>").text(item.content);
						content.css("color","#000000");
						var datediv=$("<div></div>");
						datediv.attr("class","csdn-time");
						var date=$("<span></span>").text(item.blogDate);
						datediv.css("position","absolute");
						datediv.css("margin-top","70px");
						date.css("color","#acafa7");
						datediv.append(date);
						box.attr("class","csdn-con");
						article.attr("class","csdn-article");
						article.append(writter);
						article.append(content);
						box.append(article);
						box.append(datediv);
						$("#csdnbox1").append(box);
					});
					},
					});
					}
					getblog();
					function writtingblog(){
								$("#writ-blog").remove();
								var textbox=$("<form></form>");
								textbox.attr("id","writ-blog");
								textbox.attr("class","csdn-box");
								textbox.css("background-color","#fff");
								textbox.css("height","270px");
								var user=$("<p></p>").text(localStorage.id);
								user.hide();
								var textdiv=$("<div></div>");
								textdiv.css("margin","10px");
								
								var text=$("<textarea></textarea>");
								text.attr("class","csdn-text");
								
								var btn=$("<span></span>").text("取消");
								btn.attr("class","csdn-btn");
								btn.click(function(){
									$("#writ-blog").remove();
								});
								
								//btn.attr("onclick","cancel();");
								
								
								var subbtn=$("<span></span>").text("提交");
								subbtn.click(
								function(){
									var value=text.val();
									console.log(value);
									
										var settings = {
										  "url": "http://172.81.239.44/Blog/writeBlog",
										  "method": "POST",
										  "timeout": 0,
										  "headers": {
										    "Content-Type": "application/json"
										  },
										  "data": JSON.stringify({"userId":usernam,"content":value}),
										};
										
										$.ajax(settings).done(function (response) {
										alert("提交成功！");
										  console.log(response);
										});
								
									
								
									
									}<!--function-->
								);<!--click-->
								
								
								subbtn.attr("class","csdn-btn");
								textdiv.append(text);
								textbox.append(user);
								textbox.append(textdiv);
								textbox.append(btn);
								textbox.append(subbtn);
								$("#writting").append(textbox);
							}
							
					var change=$("<p></p>").text("换一批");
					change.css("text-align","right");
					change.css("font-size","10px");
					change.css("margin-right","15px");
					change.click(function(){
						$(".csdn-con").remove();
					//	t=t+1;
						getblog();	
					});
					change.attr("id","changement");
					$("#csdnbox1").append(change);
				//function getinformation(){};<!--获取blog信息-->
				</script>
				
			</body>
		</html>
		