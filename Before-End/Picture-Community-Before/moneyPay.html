<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css"/>
		<link rel="stylesheet" type="text/css" href="css/page.css"/>
		<link rel="stylesheet" type="text/css" href="css/moneyPay.css"/>
		<link rel="stylesheet" type="text/css" href="css/information.css"/>
		<script src="js/jquery.min.js"></script>
		<title>图片社区</title>
		<style>
			.mark-style{
				border: 1px solid darkgrey;
				margin-top: 5px;
				padding: 0 31.5px;
				align-content: center;
				border-radius: 5px;
			}
			.header-style{
				font-size:20px;
				margin: 20px 254px;
				color: #000000;
				font-weight: 500;
				letter-spacing: 3px;
			}
		</style>
		<title></title>
	</head>
	<body>
		
		<!-- 导航栏 -->
		<div class="title-style">
			<div class="nav-style">
				<div class="navbar-nav">
					<ul class="nav nav-tabs" role="tablist">
						<li role="presentation" style="margin: 0 40px 0 0;" >
							<span style="height: 40px;line-height: 40px;font-weight: bold;font-size: 18px;" id="mainPage">图片社区</span>
						</li>
						<li role="presentation" style="margin: 0 20px 0 0;position: absolute;top:0px;left: 150px;display: flex;">
							<div style="width: 40px;height: 40px;background-color: white;border:none;border-bottom: 1px solid #0A88D3 ; border-top: 1px solid #0A88D3 ;">
								<svg width="40px" height="40px" viewBox="0 0 16 16" class="bi bi-search" style="padding-left: 10px; padding-top:15px;background-color: white;position: absolute;top:-5px" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
									<path fill-rule="evenodd" d="M10.442 10.442a1 1 0 0 1 1.415 0l3.85 3.85a1 1 0 0 1-1.414 1.415l-3.85-3.85a1 1 0 0 1 0-1.415z"/>
									<path fill-rule="evenodd" d="M6.5 12a5.5 5.5 0 1 0 0-11 5.5 5.5 0 0 0 0 11zM13 6.5a6.5 6.5 0 1 1-13 0 6.5 6.5 0 0 1 13 0z"/>
								</svg>
							</div>
							<input type="text" id="search" style="width: 300px;height: 40px;font-size: 16px;border: none;border-top: 1px solid #0A88D3 ;border-bottom: #0A88D3 1px solid;"/>
						</li>
						<li role="presentation" class="dropdown" style="margin: 0 200px 0 910px;">
						    <button class="btn btn-primary dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown"
						      aria-haspopup="true" aria-expanded="true">探索
							<span class="caret"></span>
						    </button>
							<table class="dropdown-menu" aria-labelledby="dropdownMenu1">
								<tr>
									<th>About</th>
								</tr>
								<tr>
									<td id="blog">博客</td>
								</tr>
								<tr>
									
									<td id="exit">注销</td>
								</tr>
								<tr>
									<td id="us">关于我们</td>
								</tr>
							</table>
						</li>
						<div id="navbar" style="position: absolute;left: 1200px; top:10px; display: flex;">
							<li style="margin: 0 40px 0 20px;"><a id="login" style="color: black;" href="loginPage.html">登录</a></li>
							<li style="margin: 0 40px 0 20px;"><a id="register" style="color: black;" href="registerPage.html">注册</a></li>
						</div>
					</ul>
				</div>
			</div>
		</div>
		
		<script>
			if(localStorage.userId!=undefined)
			{
				console.log(localStorage.userId);
				$("#login").hide();
				$("#register").hide();
				$("#exit").hide();
				var username=$("<span></span>").text("您好！"+localStorage.userName);
				username.css("position","absolute");
				username.css("left","-15px");
				username.css("top","-1px");
				$("#navbar").append(username);
				username.click(function(){
					//跳转
					window.location.href="个人图片主页.html";
				})
			}
			else
			{
				$("#exit").hide();
			}
			$("#mainPage").click(function(){
				window.location.href="new凯.html";
			});
			$("blog").click(function(){
				window.location.href="blog.html";
			});
			$("#exit").click(function(){
				localStorage.Token="";
				localStorage.picId="";
				localStorage.userId="";
				localStorage.tag="";
				localStorage.userName="";
				username.hide();
				$("#login").show();
				$("#register").show();
			});
			$("#us").click(function(){
				window.location.href="us.html";
			});
			$("#login").click(function(){
				window.location.href="loginPage.html";
			});
			$("#register").click(function(){
				window.location.href="registerPage.html";
			});
			$("#search").bind("keyup",function(event){
				if(event.keyCode=="13")
				{
					localStorage.tag=$("#search").val();
					window.location.href="showPicture.html";
					document.getElementById("search").value="";
				}
			});
		</script>
			
			
			
			<!-- 内容展示页面 -->
			<div id="content" class="clearfix">
				
				<!-- 显示选择栏的内容 -->
				<div style="margin: 30px auto;">
					<div id="account_tabs" class="tab_menu hide-xs hide-sm hide-md" style="margin:auto;border-top:0">
						<div style="max-width:1440px;margin:auto;padding:0 5px;text-align:left">
							<a style="float:right" href="个人图片主页.html">
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">我的简历
									</font>
								</font>
							</a>
							<a href="pictureShow.html">
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">图片
									</font>
								</font>
							</a>
							<a href="#我的博客">
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">博客
									</font>
								</font>
							</a>
							<a href="moneyPay.html"  class="selected">
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">钱包
									</font>
								</font>
							</a>
							<a href="myinformation.html">
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">设置
									</font>
								</font>
							</a>
						</div>
					</div>
				</div>
				
				<!-- 显示钱包内容 -->
				<div id="app">
					<!-- 蓝条 -->
					<div class="top-bp">
					</div>
					
					<div id="content" class="clearfix">
					
						<!-- 中间输入框 -->
						<div id="sign_in_out" style="padding: 10px;">
							<div class="window" style="max-width: 600px;">
								<div style="padding: 20px 25px;">
									<!-- 用户名以及头像 -->
									<div class="tab-menu" style="border-top: 0;margin: 0 0 35px;font-size: 20px;">
										<span style="background-image: url(&quot;http://i0.hdslb.com/bfs/face/01dbc13793a683bf25de3b63c7c175c10f95dfc7.jpg&quot;);"></span>
										<p id="id_username">桔子柿饼</p>
									</div>
									<!-- 账户余额 -->
									<div class="social_auth" style="margin: 0 0 30px;text-align: center;">
										当前账户余额：<a id="userbalance">0</a>币
									</div>
									<form id="login_form" spellcheck="false" class="right_side pure-form">
										<!-- 充值金额 -->
										<p>
											请输入充值金额：
											<input type="text" value="0" id="id_paymoney" oninput = "value=value.replace(/[^\d]/g,'')">
										</p>
										<!-- 充值按钮 -->
										<div style="text-align: center;">
											<div></div>
											<input style="text-align:center;width: 300px;" class="pure-button button-green" type="submit" value="B币充值" onclick="payMoney()">
										</div>
									</form>
									
								</div>
								
								<!-- 充值记录 -->
								<div id="mark" style="color: #000000;">
									
								</div>
								
								
								<div style="padding:20px 25px;background:#f7f7f7;font-size:13px;line-height:1.7;text-align:center">
								<a href="termsOfPay.html">充值注意事项</a>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
		
		<script>
			var userName=localStorage.username;
			var userId=localStorage.userId;
			var token=localStorage.Token;
			
			$('#id_username').text=userName;
			
			//账户余额显示
			$.ajax({
				"url": "http://172.81.239.44/Wallet/getWalletInfo",
				"method": "GET",
				"timeout": 0,
				"data": JSON.stringify({"userId":userId}),
				success:function(response){
					if(response.success==true)
					{
						$('userbalance').text=responce.nowCoin;
					}
					else
					{
						window.location.href="loginPage.html";
					}
				},
				error:function(response){
				  alert("未登录");
				  window.location.href="loginPage.html";
				}
			});
			
			//充值记录
			$.ajax({
				"url": "http://172.81.239.44/Wallet/getDepositRecord",
				"method": "GET",
				"timeout": 0,
				"data": JSON.stringify({"userId":userId}),
				success:function(response){
					if(response.success==true)
					{
						var arr=response.list;
						var header=$("<span></span>").text("充值记录");
						header.css("color","black");
						header.css("font-size","20px");
						header.attr("class","header-style");
						$("#mark").append(header);
						arr.forEach(function(item,index){
							var jilu=$("<div></div>");
							jilu.css("height","80px");
							jilu.css("width","90%");
							jilu.css("margin-left","31.5px");
							jilu.attr("class","mark-style");
							$("#mark").append(jilu);
							var data=$("<div></div>").text("时间: "+"item.data");
							data.css("height","30px");
							data.css("padding-left","40px");
							data.css("color","black");
							data.css("padding-top","10px")
							var number=$("<div></div>").text("充值金额"+"item.number");
							number.css("padding-left","40px");
							number.css("margin-top","10px");
							number.css("height","30px");
							number.css("color","black");
							jilu.append(data);
							jilu.append(number);
						});
					}
					else
					{
						var header=$("<span></span>").text("充值记录显示失败，请刷新");
						header.css("color","black");
						header.css("font-size","20px");
						header.attr("class","header-style");
						$("#mark").append(header);
					}
				},
				error:function(response){
				  alert("网络延迟，请刷新重试");
				}
			});
			
			//交易记录
			$.ajax({
				"url": "http://172.81.239.44/Wallet/getDepositRecord",
				"method": "GET",
				"timeout": 0,
				"data": JSON.stringify({"userId":"2"}),
				success:function(response){
					if(response.success==true)
					{
						// var arr=response.list;
						var header=$("<span></span>").text("交易记录");
						header.css("color","black");
						header.css("font-size","20px");
						header.attr("class","header-style");
						$("#mark").append(header);
						arr.forEach(function(item,index){
							var jilu=$("<div></div>");
							jilu.css("height","80px");
							jilu.css("width","90%");
							jilu.css("margin-left","31.5px");
							jilu.attr("class","mark-style");
							$("#mark").append(jilu);
							var data=$("<div></div>").text("时间: "+"item.data");
							data.css("height","30px");
							data.css("padding-left","40px");
							data.css("color","black");
							data.css("padding-top","10px")
							var number=$("<div></div>").text("交易金额"+"item.number");
							number.css("padding-left","40px");
							number.css("margin-top","10px");
							number.css("height","30px");
							number.css("color","black");
							jilu.append(data);
							jilu.append(number);
						});
					}
					else
					{
						var header=$("<span></span>").text("充值记录显示失败，请刷新");
						header.css("color","black");
						header.css("font-size","20px");
						header.attr("class","header-style");
						$("#mark").append(header);
					}
				},
				error:function(response){
				  alert("网络延迟，请刷新重试");
				}
			});
			
			// 充值按钮实现
			function payMoney(){
				var paymoney=$('#id_paymoney').val();
				var balance=$('#userbalance').val();
				$.ajax({
					"url": "http://172.81.239.44/Wallet/depositWallet",
					"method": "POST",
					"timeout": 0,
					"data": JSON.stringify({"userId":userId,"content":paymoney}),
					success:function(response){
						if(response.success==true)
						{
							balance.text=responce.nowCoin;
							
						}
						else
						{
							window.location.href="loginPage.html";
						}
					},
					error:function(response){
					  alert("刷新重试");
					}
				});
			};

			
			
		</script>
		
		<script src="js/bootstrap.min.js"></script>
		<script src="js/jquery.min.js"></script>
	</body>
</html>
